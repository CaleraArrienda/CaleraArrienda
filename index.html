<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para mi Pochi üíñ</title>
    <!-- Fuentes Bonitas -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&family=Pacifico&display=swap" rel="stylesheet">
    <!-- Iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* =========================================
           ESTILOS (CSS)
           ========================================= */
        :root {
            --primary: #ff6b81;
            --secondary: #ff4757;
            --bg-color: #ffeaa7;
            --text: #2f3542;
            --glass: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(120deg, #f6d365 0%, #fda085 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            text-align: center;
            color: var(--text);
            user-select: none;
            padding: 20px;
        }

        /* Contenedor Principal */
        .game-container {
            width: 100%;
            max-width: 500px;
            background: var(--glass);
            border-radius: 25px;
            padding: 25px;
            box-shadow: var(--shadow);
            position: relative;
            transition: all 0.5s ease;
            backdrop-filter: blur(5px);
            border: 4px solid white;
        }

        h1, h2 {
            font-family: 'Fredoka One', cursive;
            color: var(--secondary);
            margin-bottom: 15px;
        }

        h1 { font-size: 2rem; }
        h2 { font-size: 1.5rem; }

        p { margin-bottom: 20px; font-size: 1.1rem; line-height: 1.5; }

        /* Botones Bonitos */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Fredoka One', cursive;
            box-shadow: 0 5px 0 #e84118;
            transition: transform 0.1s;
            margin-top: 10px;
            width: 100%;
            touch-action: manipulation;
        }

        .btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        /* Barra de Progreso */
        .progress-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 400px;
            height: 20px;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
            overflow: hidden;
            z-index: 100;
            border: 2px solid white;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            transition: width 0.5s ease;
        }

        /* PANTALLAS (Secciones) */
        .screen { display: none; animation: popIn 0.5s ease; }
        .screen.active { display: block; }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* --- NIVEL 1: ATRAPA BESOS --- */
        #game-area-1 {
            height: 250px;
            position: relative;
            background: #fff0f0;
            border-radius: 15px;
            overflow: hidden;
            cursor: crosshair;
            border: 2px dashed var(--primary);
            touch-action: none; /* Mejor para celular */
        }
        .falling-heart {
            position: absolute;
            font-size: 2.5rem;
            cursor: pointer;
            animation: float 2s infinite;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- NIVEL 2: MEMORIA --- */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 20px;
        }
        .card {
            background: white;
            aspect-ratio: 1/1;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            -webkit-tap-highlight-color: transparent;
        }
        .card.flipped { background: #ffeaa7; transform: rotateY(180deg); }
        .card.matched { background: #55efc4; animation: pulse 0.5s; visibility: hidden; opacity: 0;}

        /* --- NIVEL 3: QUIZ --- */
        .quiz-option {
            background: white;
            border: 2px solid #eee;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.2s;
            font-weight: bold;
        }
        .quiz-option:active { background: #eee; }

        /* --- CARTA FINAL --- */
        .letter-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: left;
            font-family: 'Pacifico', cursive; /* Fuente tipo manuscrita */
            font-size: 1.2rem;
            color: #444;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ffccd5;
            box-shadow: inset 0 0 20px #fff0f0;
            line-height: 1.6;
        }

        /* Animaci√≥n Shake (Error) */
        .shake { animation: shake 0.5s; }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        /* Confeti */
        canvas#confetti {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes float { 0% { transform: translateY(0); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0); } }

    </style>
</head>
<body>

    <!-- Canvas para el premio final -->
    <canvas id="confetti"></canvas>

    <!-- Barra de Progreso Superior -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- PANTALLA 1: BIENVENIDA -->
    <div id="screen-welcome" class="game-container screen active">
        <h1>¬°Hola Pochi! üêª</h1>
        <p>Hoy es nuestro aniversario, pero el regalo te lo tienes que ganar.</p>
        <p>He preparado una <strong>Misi√≥n de Amor</strong>. Tienes que completar 3 niveles para desbloquear mi carta secreta.</p>
        <p>¬øLista para jugar?</p>
        <button class="btn" onclick="goToLevel(1)">¬°Estoy Lista!</button>
    </div>

    <!-- NIVEL 1: CLICKER -->
    <div id="screen-level1" class="game-container screen">
        <h2>Nivel 1: Atrapa mi Amor üíã</h2>
        <p>Toca <strong>10 corazones</strong> r√°pido antes de que desaparezcan.</p>
        <h3 id="score1" style="color:var(--primary); font-size: 2rem;">0 / 10</h3>
        
        <div id="game-area-1"></div>
    </div>

    <!-- NIVEL 2: MEMORIA -->
    <div id="screen-level2" class="game-container screen">
        <h2>Nivel 2: Conexi√≥n Mental üß†</h2>
        <p>Encuentra las parejas de emojis.</p>
        <div class="memory-grid" id="memory-board"></div>
    </div>

    <!-- NIVEL 3: QUIZ -->
    <div id="screen-level3" class="game-container screen">
        <h2>Nivel 3: Nuestra Historia üìñ</h2>
        <p id="question-text" style="font-weight: bold; font-size: 1.3rem;">Pregunta...</p>
        <div id="quiz-options"></div>
    </div>

    <!-- PANTALLA FINAL: CARTA -->
    <div id="screen-final" class="game-container screen" style="max-width: 600px;">
        <h1>¬°Felicidades, Amor! üéâ</h1>
        <p>Pasaste todos los niveles. Aqu√≠ tienes tu recompensa:</p>
        
        <div class="letter-content" id="typewriter"></div>
        
        <button class="btn" style="margin-top: 20px;" onclick="restart()">Jugar de nuevo</button>
    </div>

    <script>
        /* =========================================
           CONFIGURACI√ìN PERSONALIZADA (TU INFORMACI√ìN)
           ========================================= */
        
        // --- PREGUNTAS DEL QUIZ ---
        const questions = [
            {
                q: "¬øEn qu√© lugar nos conocimos por primera vez?", 
                options: ["En el parque", "En una fiesta", "En el Centro Comercial", "En la universidad"],
                correct: 2 // El 2 corresponde a "En el Centro Comercial" (0, 1, 2...)
            },
            {
                q: "¬øQu√© es lo que m√°s me gusta de ti?",
                options: ["Tu sonrisa", "Tus ojos", "Todo tu ser", "Tus abrazos"],
                correct: 2 // "Todo tu ser"
            },
            {
                q: "¬øCu√°l es mi comida favorita?",
                options: ["Pizza", "Sushi", "Hamburguesa", "Tacos"],
                correct: 0 // Cambia este n√∫mero seg√∫n la opci√≥n correcta (0=Pizza, 1=Sushi...)
            }
        ];

        // --- MENSAJE FINAL ---
        const finalMessage = `¬°Feliz Aniversario, mi amor preciosa! üíñ

¬øQui√©n dir√≠a que ese d√≠a en el Centro Comercial mi vida cambiar√≠a para siempre? Desde que te vi, supe que hab√≠a algo especial en ti.

Gracias por ser mi compa√±era de juegos, mi mejor amiga y el amor de mi vida. No necesito nada m√°s si te tengo a mi lado.

Prometo seguir cuid√°ndote, haci√©ndote re√≠r y am√°ndote en cada nivel que pasemos juntos.

Te amo con todo mi coraz√≥n, Pochi.
Eres la m√°s hermosa del universo. üöÄ‚ù§Ô∏è`;

        /* =========================================
           MOTOR DEL JUEGO (NO TOCAR)
           ========================================= */

        let score1 = 0;
        
        function updateProgress(percent) {
            document.getElementById('progressBar').style.width = percent + '%';
        }

        function goToLevel(level) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            
            if (level === 1) {
                document.getElementById('screen-level1').classList.add('active');
                updateProgress(10);
                startGame1();
            } else if (level === 2) {
                document.getElementById('screen-level2').classList.add('active');
                updateProgress(40);
                startGame2();
            } else if (level === 3) {
                document.getElementById('screen-level3').classList.add('active');
                updateProgress(70);
                startGame3();
            } else if (level === 4) {
                document.getElementById('screen-final').classList.add('active');
                updateProgress(100);
                startFinal();
            }
        }

        // --- L√ìGICA NIVEL 1 ---
        function startGame1() {
            score1 = 0;
            document.getElementById('score1').innerText = "0 / 10";
            document.getElementById('game-area-1').innerHTML = ''; // Limpiar
            
            const interval = setInterval(() => {
                if (score1 >= 10) {
                    clearInterval(interval);
                    setTimeout(() => goToLevel(2), 500);
                    return;
                }
                spawnHeart();
            }, 700);
        }

        function spawnHeart() {
            const area = document.getElementById('game-area-1');
            if(!area.offsetParent) return; // Si no est√° visible, parar

            const heart = document.createElement('div');
            heart.classList.add('falling-heart');
            heart.innerHTML = '‚ù§Ô∏è'; 
            
            const x = Math.random() * (area.clientWidth - 50);
            const y = Math.random() * (area.clientHeight - 50);
            
            heart.style.left = x + 'px';
            heart.style.top = y + 'px';
            
            // Evento Touch para celular
            const handleTap = (e) => {
                e.preventDefault();
                score1++;
                document.getElementById('score1').innerText = score1 + " / 10";
                heart.style.transform = "scale(1.5)";
                heart.style.opacity = "0";
                setTimeout(() => heart.remove(), 200);
            };

            heart.addEventListener('touchstart', handleTap);
            heart.addEventListener('click', handleTap);

            area.appendChild(heart);
            
            setTimeout(() => { if(heart.parentNode) heart.remove(); }, 1500);
        }

        // --- L√ìGICA NIVEL 2 ---
        const emojis = ['üêª', 'üõçÔ∏è', 'üçï', 'üê±', 'üåû', 'üç¶', 'üíç', 'üêß']; // A√±ad√≠ bolsa de compras
        let cards = [...emojis, ...emojis];
        let flippedCards = [];
        let matchedPairs = 0;

        function startGame2() {
            const board = document.getElementById('memory-board');
            board.innerHTML = '';
            matchedPairs = 0;
            flippedCards = [];
            cards.sort(() => 0.5 - Math.random());
            
            cards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.emoji = emoji;
                card.dataset.index = index;
                card.innerHTML = '<i class="fas fa-question" style="font-size: 1rem; color: #ddd;"></i>';
                
                card.onclick = () => flipCard(card);
                board.appendChild(card);
            });
        }

        function flipCard(card) {
            if (flippedCards.length < 2 && !card.classList.contains('flipped')) {
                card.classList.add('flipped');
                card.innerText = card.dataset.emoji;
                flippedCards.push(card);

                if (flippedCards.length === 2) {
                    checkMatch();
                }
            }
        }

        function checkMatch() {
            const [c1, c2] = flippedCards;
            if (c1.dataset.emoji === c2.dataset.emoji) {
                matchedPairs++;
                setTimeout(() => {
                    c1.classList.add('matched');
                    c2.classList.add('matched');
                    if (matchedPairs === emojis.length) {
                        setTimeout(() => goToLevel(3), 800);
                    }
                }, 500);
            } else {
                setTimeout(() => {
                    c1.classList.remove('flipped');
                    c1.innerHTML = '<i class="fas fa-question" style="font-size: 1rem; color: #ddd;"></i>';
                    c2.classList.remove('flipped');
                    c2.innerHTML = '<i class="fas fa-question" style="font-size: 1rem; color: #ddd;"></i>';
                }, 800);
            }
            flippedCards = [];
        }

        // --- L√ìGICA NIVEL 3 ---
        let qIndex = 0;
        function startGame3() {
            qIndex = 0;
            loadQuestion();
        }

        function loadQuestion() {
            if (qIndex >= questions.length) {
                goToLevel(4);
                return;
            }
            const q = questions[qIndex];
            document.getElementById('question-text').innerText = q.q;
            const container = document.getElementById('quiz-options');
            container.innerHTML = '';

            q.options.forEach((opt, idx) => {
                const div = document.createElement('div');
                div.classList.add('quiz-option');
                div.innerText = opt;
                div.onclick = () => {
                    if (idx === q.correct) {
                        div.style.background = '#55efc4';
                        div.style.borderColor = '#00b894';
                        setTimeout(() => {
                            qIndex++;
                            loadQuestion();
                        }, 500);
                    } else {
                        div.style.background = '#ff7675';
                        div.classList.add('shake');
                        setTimeout(() => {
                            div.style.background = 'white';
                            div.classList.remove('shake');
                        }, 500);
                    }
                };
                container.appendChild(div);
            });
        }

        // --- FINAL ---
        function startFinal() {
            confettiEffect();
            typeWriterEffect();
        }

        function typeWriterEffect() {
            const container = document.getElementById('typewriter');
            container.innerHTML = '';
            let i = 0;
            function type() {
                if (i < finalMessage.length) {
                    container.innerHTML += finalMessage.charAt(i) === '\n' ? '<br>' : finalMessage.charAt(i);
                    i++;
                    setTimeout(type, 50);
                }
            }
            type();
        }

        function restart() {
            location.reload();
        }

        function confettiEffect() {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const pieces = [];
            for(let i=0; i<300; i++) {
                pieces.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    size: Math.random() * 10 + 5,
                    speed: Math.random() * 5 + 2
                });
            }

            function draw() {
                ctx.clearRect(0,0,canvas.width,canvas.height);
                pieces.forEach(p => {
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    p.y += p.speed;
                    if(p.y > canvas.height) p.y = -20;
                });
                requestAnimationFrame(draw);
            }
            draw();
        }
    </script>
</body>
</html>
